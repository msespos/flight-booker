<%= form_with url: '/flights', method: :get, local: true do |f| %>
  Departing from:
  <% if @found_flights.nil? %>
    <%= select :flight, :departure_airport_id, @airport_options %>
  <% else %>
    <%= select :flight, :departure_airport_id, @airport_options, selected: params[:flight][:departure_airport_id] %>
  <% end %>
  Arriving at:
  <% if @found_flights.nil? %>
    <%= select :flight, :arrival_airport_id, @airport_options %>
  <% else %>
    <%= select :flight, :arrival_airport_id, @airport_options, selected: params[:flight][:arrival_airport_id] %>
  <% end %>
  Number of Passengers:
  <%= select_tag :number_of_passengers, options_for_select(@passenger_options, params[:number_of_passengers]) %>
  Departure Date:
  <% if @found_flights.nil? %>
    <%= select :flight, :departure_date, Flight.all
               .collect { |f| format_date(f[:departure_date]) }.uniq %>
  <% else %>
    <%= select :flight, :departure_date, Flight.all
               .collect { |f| format_date(f[:departure_date]) }.uniq, selected: params[:flight][:departure_date] %>
  <% end %>
  <%= f.submit "Go!" %>
<% end %>
<% unless @found_flights.nil? %>
  <% if @found_flights[0].nil? %>
    No flights found
  <% else %>
    <%= form_with url: '/bookings/new', method: :get, local: true do |form| %>
      <% hidden_field :flight, :number_of_passengers %>
      <% @found_flights.each do |f| %>
        <%= radio_button :flight, :id, f[:id] %>
        <%= Flight.airport_code(f[:departure_airport_id]) %>
        <%= Flight.airport_code(f[:arrival_airport_id]) %>
        <%= format_date(f[:departure_date]) %>
        <%= format_time(f[:departure_time]) %><br>
      <% end %>
      <%= form.submit "Select flight" %>
    <% end %>
  <% end %>
<% end %>
